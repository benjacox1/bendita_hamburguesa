<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bendita Hamburguesa - Panel Administraci√≥n</title>
  <link rel="stylesheet" href="admin.css" />
  <script src="auth.js"></script>
  <script>
    if (typeof requireAuth === 'function') {
      requireAuth();
    }
  </script>
</head>
<body>
  <header>
    <h1>Bendita Hamburguesa - Panel de Administraci√≥n</h1>
    <nav>
      <button class="tab-button active" data-tab="pedidos">Pedidos</button>
      <button class="tab-button" data-tab="stock">Stock Productos</button>
      <button id="logout-btn" class="tab-button" style="margin-left:auto;background:#ef4444;color:#fff;">Salir</button>
    </nav>
  </header>

  <main>
    <!-- Secci√≥n Pedidos -->
    <section id="tab-pedidos" class="tab-section active">
      <h2>Gesti√≥n de Pedidos</h2>
      <form id="form-nuevo-pedido" class="card">
        <h3>Ingresar nuevo pedido</h3>
        <div class="grid">
          <label>
            Cliente
            <input required name="cliente" placeholder="Nombre del cliente" />
          </label>
          <label>
            Producto / Detalle
            <input required name="detalle" placeholder="Producto y detalles" />
          </label>
          <label>
            Tipo
            <select name="tipo">
              <option value="alimento">Alimento</option>
              <option value="bebida">Bebida</option>
            </select>
          </label>
          <label>
            Importe ($)
            <input type="number" step="0.01" min="0" name="importe" />
          </label>
        </div>
        <button type="submit" class="primary">Agregar Pedido</button>
      </form>

      <div class="toolbar">
        <input id="filtro-pedidos" placeholder="Filtrar por cliente o detalle..." />
        <button id="limpiar-pedidos" class="danger small">Limpiar Todos</button>
        <button id="refrescar-pedidos" class="small" style="background:#2563eb;color:#fff;">Refrescar</button>
      </div>

      <table class="tabla" id="tabla-pedidos">
        <thead>
          <tr>
            <th>#</th>
            <th>Cliente</th>
            <th>Detalle</th>
            <th>Tipo</th>
            <th>Importe</th>
            <th>Estado</th>
            <th>Acciones</th>
            <th>Eliminar</th>
          </tr>
        </thead>
        <tbody>
          <!-- filas din√°micas -->
        </tbody>
      </table>
    </section>

    <!-- Secci√≥n Stock -->
    <section id="tab-stock" class="tab-section">
      <h2>Stock de Productos</h2>
      <form id="form-nuevo-producto" class="card">
        <h3>Agregar / Actualizar Producto</h3>
        <div class="grid">
          <label>
            Nombre
            <input required name="nombre" placeholder="Ej: Hamburguesa doble" />
          </label>
          <label>
            Categor√≠a
            <input name="categoria" placeholder="Ej: Bebida, Comida..." />
          </label>
          <label>
            Stock Inicial
            <input type="number" min="0" name="stock" required />
          </label>
          <label>
            Stock M√≠nimo (alerta)
            <input type="number" min="0" name="stockMin" value="5" />
          </label>
          <label>
            Precio ($)
            <input type="number" step="0.01" min="0" name="precio" />
          </label>
        </div>
        <button type="submit" class="primary">Guardar Producto</button>
      </form>

      <div class="toolbar">
        <input id="filtro-stock" placeholder="Filtrar por nombre o categor√≠a..." />
        <button id="limpiar-stock" class="danger small">Limpiar Productos</button>
        <button id="sync-catalog" class="small" style="background:#2563eb;color:#fff;">Sync Cat√°logo</button>
      </div>

      <table class="tabla" id="tabla-stock">
        <thead>
          <tr>
            <th>#</th>
            <th>Producto</th>
            <th>Categor√≠a</th>
            <th>Precio</th>
            <th>Stock</th>
            <th>Estado</th>
            <th>Ajustar</th>
            <th>Eliminar</th>
          </tr>
        </thead>
        <tbody>
          <!-- filas din√°micas -->
        </tbody>
      </table>
    </section>
  </main>

  <footer>
    <small>Panel local (sin backend todav√≠a). Estados de pedido: En Espera ‚Üí Prepar√°ndose ‚Üí Listo para Retirar ‚Üí Retirado.</small>
  </footer>

  <!-- Panel Debug Pedidos -->
  <div id="debug-toggle" class="debug-toggle" title="Mostrar/Ocultar Debug">üõ† Debug</div>
  <div id="debug-panel" class="debug-panel" hidden>
    <div class="debug-head">
      <strong>Debug Pedidos</strong>
      <div class="debug-actions">
  <button id="debug-test" class="small" title="Crear pedido de prueba">Pedido Prueba</button>
  <button id="debug-deltest" class="small danger" title="Eliminar pedidos de prueba">Borrar Pruebas</button>
        <button id="debug-export" class="small" title="Exportar CSV">Export CSV</button>
        <button id="debug-copiar" class="small">Copiar JSON</button>
        <button id="debug-recargar" class="small">Recargar</button>
        <button id="debug-cerrar" class="small danger">Cerrar</button>
      </div>
    </div>
    <pre id="debug-json" class="debug-pre">(vac√≠o)</pre>
  </div>

  <script src="../config.js"></script>
  <script src="tabs.js"></script>
  <script src="orders.js"></script>
  <script src="stock.js"></script>
  <script>
    const logoutBtn = document.getElementById('logout-btn');
    if (logoutBtn && typeof adminLogout === 'function') {
      logoutBtn.addEventListener('click', () => adminLogout());
    }
  </script>
</body>
</html>
